/**
* @app GoolgeReviewWidget
* @desc A widget pulls up to 5 Google reviews using Google Place Javascript API
* @version 1.0.0
* @license The MIT License (MIT)
* @author Leo Lee
*/
!function(e,r,t){"use strict";var i={};i.helpers={extendObj:function(){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])arguments[e].hasOwnProperty(r)&&(arguments[e][r]&&arguments[e][r].constructor&&arguments[e][r].constructor===Object?(arguments[0][r]=arguments[e][r]||{},this.extendObj(arguments[0][r],arguments[e][r])):arguments[0][r]=arguments[e][r]);return arguments[0]},createElem:function(e,r){var t=document.createElement(e);for(var i in r)t.setAttribute(i,r[i]);return t},ellipsis:function(e,r){var t=e.textContent,a=t.split(/\s+/).length;if(a>r){var l=t.split(/\s+/,r).join(" ")+"...";e.textContent=l;var s=document.createElement("div"),n=i.helpers.createElem("a",{class:"rm-link"});n.textContent="Read More",s.appendChild(n),e.parentElement.appendChild(s),n.addEventListener("click",function(){"true"!==this.getAttribute("data-clicked")?(e.textContent=t,this.textContent="Read Less",this.setAttribute("data-clicked",!0)):(e.textContent=l,this.textContnet="Read More",this.setAttribute("data-clicked",!1))})}},initSlider:function(e){for(var r=e.querySelectorAll(".grw-slider-nav a"),t=e.querySelector(".grw-slider-wrapper"),i=0;i<r.length;i++){var a=r[i];document.addEventListener&&a.addEventListener("click",function(i){i.preventDefault();var a=this;a.className="grw-slide-current";for(var l=0;l<r.length;++l){var s=r[l];s!==a&&(s.className="")}var n=parseInt(a.getAttribute("data-grw-slide"),10)+1,d=e.querySelector(".grw-review-slide:nth-child("+n+")");t.style.left="-"+d.offsetLeft+"px"},!1)}}},i.init=function(e){var r={target:"",placeid:"",theme:"dark",numOfWords:20,horizontal:!0};e=i.helpers.extendObj({},r,e),console.log(e);var t=document.querySelector(e.target);if(t){if(""===e.placeid||!google)return;var a=new google.maps.places.PlacesService(document.querySelector(e.target));a.getDetails({placeId:e.placeid},function(r,a){if(a===google.maps.places.PlacesServiceStatus.OK){var l=i.helpers.createElem("div",{class:"grw-wrapper"});t.appendChild(l);var s=i.helpers.createElem("div",{class:"google-reviews grw-theme-"+e.theme});l.appendChild(s);var n=i.buildWidgetHeader(r),d=i.buildReviews(r,e),o=i.buildWidgetFooter();if(s.appendChild(n),s.appendChild(d),s.appendChild(o),e.numOfWords>0){var c=document.querySelectorAll(".grw-review-content p");c.forEach(function(r,t){i.helpers.ellipsis(r,e.numOfWords)})}}})}},i.buildWidgetHeader=function(e){console.log(e);var r=e.name,t=e.url,a=e.rating,l=i.helpers.createElem("div",{class:"grw-business-header grw-clear-fix"});return l.innerHTML='<div class="grw-header-content-wrapper"><span class="grw-business-name"><a href="'+t+'" rel="nofollow" target="_blank" title="'+r+'">'+r+'</a></span><div class="grw-google-rating-content"><div class="grw-google-star-rating-wrapper"><div class="grw-google-star-rating" style="width:'+Math.round(67*a/5)+'px"></div></div></div><div class="grw-rating-value">'+a+" out of 5 stars</div></div>",l},i.buildReviews=function(e,r){var t="grw-reviews-wrapper",a="grw-review",l=i.helpers.createElem("div",{class:"grw-reviews-compact grw-slider"}),s=i.helpers.createElem("div",{class:"grw-slider-nav"});r.horizontal&&(t="grw-reviews-wrapper grw-slider-wrapper",a="grw-review grw-review-slide");for(var n=i.helpers.createElem("div",{class:t}),d=e.reviews,o=0;o<d.length;o++){var c=d[o].author_name,v=d[o].rating,g=d[o].text,p='<div class="'+a+'"><div class="grw-author">'+c+'</div><div class="grw-review-rating"><div class="grw-google-star-rating-wrapper"><div class="grw-google-star-rating" style="width:'+Math.round(67*v/5)+'px"></div></div></div><div class="grw-review-content"><p>'+g+"</p></div></div>";n.innerHTML+=p;var w=i.helpers.createElem("a",{href:"#","data-grw-slide":o});0==o&&(w.className="grw-slide-current"),s.appendChild(w)}return r.horizontal?(l.appendChild(n),l.appendChild(s),i.helpers.initSlider(l),l):n},i.buildWidgetFooter=function(){var e=i.helpers.createElem("div",{class:"grw-business-footer grw-clear-fix"});return e.innerHTML='<div class="poweredByGoogle"></div>',e},window.$GrwJS=i}(this,this.document);